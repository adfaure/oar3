<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1113px" preserveAspectRatio="none" style="width:1280px;height:1113px;" version="1.1" viewBox="0 0 1280 1113" width="1280px" zoomAndPan="magnify"><defs><filter height="300%" id="fldr5w7yiyfiz" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="185" x="545.5" y="28.708">Job's execution chain</text><rect fill="#ADD8E6" height="1066.5781" style="stroke:#A80036;stroke-width:1.0;" width="428" x="1" y="40.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="47" x="191.5" y="53.02">Server</text><rect fill="#90EE90" height="1066.5781" style="stroke:#A80036;stroke-width:1.0;" width="829" x="431" y="40.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="83" x="804" y="53.02">Head Node</text><rect fill="#FFFFFF" filter="url(#fldr5w7yiyfiz)" height="858.8516" style="stroke:#A80036;stroke-width:1.0;" width="10" x="26" y="153.3828"/><rect fill="#FFFFFF" filter="url(#fldr5w7yiyfiz)" height="858.8516" style="stroke:#A80036;stroke-width:1.0;" width="10" x="92.5" y="153.3828"/><rect fill="#FFFFFF" filter="url(#fldr5w7yiyfiz)" height="14" style="stroke:#A80036;stroke-width:1.0;" width="10" x="221.5" y="298.1797"/><rect fill="#FFFFFF" filter="url(#fldr5w7yiyfiz)" height="14" style="stroke:#A80036;stroke-width:1.0;" width="10" x="357.5" y="989.2344"/><rect fill="#FFFFFF" filter="url(#fldr5w7yiyfiz)" height="858.8516" style="stroke:#A80036;stroke-width:1.0;" width="10" x="486.5" y="153.3828"/><rect fill="#FFFFFF" filter="url(#fldr5w7yiyfiz)" height="119.3984" style="stroke:#A80036;stroke-width:1.0;" width="10" x="914" y="775.4375"/><rect fill="#FFFFFF" filter="url(#fldr5w7yiyfiz)" height="14" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1087" y="804.5703"/><rect fill="#FFFFFF" filter="url(#fldr5w7yiyfiz)" height="14" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1200" y="880.8359"/><rect fill="#FFFFFF" filter="url(#fldr5w7yiyfiz)" height="179.6641" style="stroke:#000000;stroke-width:2.0;" width="715" x="551" y="723.1719"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="31" x2="31" y1="143.3828" y2="1021.2344"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="97" x2="97" y1="143.3828" y2="1021.2344"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="226" x2="226" y1="143.3828" y2="1021.2344"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="362" x2="362" y1="143.3828" y2="1021.2344"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="491" x2="491" y1="143.3828" y2="1021.2344"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="592" x2="592" y1="143.3828" y2="1021.2344"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="811.5" x2="811.5" y1="143.3828" y2="1021.2344"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="918.5" x2="918.5" y1="143.3828" y2="1021.2344"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1092" x2="1092" y1="143.3828" y2="1021.2344"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1205" x2="1205" y1="143.3828" y2="1021.2344"/><rect fill="#FEFECE" filter="url(#fldr5w7yiyfiz)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="48" x="5" y="108.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="34" x="12" y="128.0811">Leon</text><rect fill="#FEFECE" filter="url(#fldr5w7yiyfiz)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="48" x="5" y="1020.2344"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="34" x="12" y="1040.2295">Leon</text><rect fill="#FEFECE" filter="url(#fldr5w7yiyfiz)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="57" x="67" y="108.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="74" y="128.0811">Bipbip</text><rect fill="#FEFECE" filter="url(#fldr5w7yiyfiz)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="57" x="67" y="1020.2344"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="74" y="1040.2295">Bipbip</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="121" x="163" y="140.0811">Server's prologue</text><ellipse cx="226.5" cy="111.0859" fill="#FEFECE" filter="url(#fldr5w7yiyfiz)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><polygon fill="#A80036" points="222.5,99.0859,228.5,94.0859,226.5,99.0859,228.5,104.0859,222.5,99.0859" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="121" x="163" y="1033.2295">Server's prologue</text><ellipse cx="226.5" cy="1052.5313" fill="#FEFECE" filter="url(#fldr5w7yiyfiz)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><polygon fill="#A80036" points="222.5,1040.5313,228.5,1035.5313,226.5,1040.5313,228.5,1045.5313,222.5,1040.5313" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="119" x="300" y="140.0811">Server's epilogue</text><ellipse cx="362.5" cy="111.0859" fill="#FEFECE" filter="url(#fldr5w7yiyfiz)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><polygon fill="#A80036" points="358.5,99.0859,364.5,94.0859,362.5,99.0859,364.5,104.0859,358.5,99.0859" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="119" x="300" y="1033.2295">Server's epilogue</text><ellipse cx="362.5" cy="1052.5313" fill="#FEFECE" filter="url(#fldr5w7yiyfiz)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><polygon fill="#A80036" points="358.5,1040.5313,364.5,1035.5313,362.5,1040.5313,364.5,1045.5313,358.5,1040.5313" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107" x="435" y="140.0811">dedicated sshd</text><ellipse cx="491.5" cy="111.0859" fill="#FEFECE" filter="url(#fldr5w7yiyfiz)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><polygon fill="#A80036" points="487.5,99.0859,493.5,94.0859,491.5,99.0859,493.5,104.0859,487.5,99.0859" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107" x="435" y="1033.2295">dedicated sshd</text><ellipse cx="491.5" cy="1052.5313" fill="#FEFECE" filter="url(#fldr5w7yiyfiz)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><polygon fill="#A80036" points="487.5,1040.5313,493.5,1035.5313,491.5,1040.5313,493.5,1045.5313,487.5,1040.5313" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57" x="561" y="140.0811">oar user</text><ellipse cx="592.5" cy="70.0859" fill="#FEFECE" filter="url(#fldr5w7yiyfiz)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M592.5,78.0859 L592.5,105.0859 M579.5,86.0859 L605.5,86.0859 M592.5,105.0859 L579.5,120.0859 M592.5,105.0859 L605.5,120.0859 " fill="none" filter="url(#fldr5w7yiyfiz)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57" x="561" y="1033.2295">oar user</text><ellipse cx="592.5" cy="1046.5313" fill="#FEFECE" filter="url(#fldr5w7yiyfiz)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M592.5,1054.5313 L592.5,1081.5313 M579.5,1062.5313 L605.5,1062.5313 M592.5,1081.5313 L579.5,1096.5313 M592.5,1081.5313 L605.5,1096.5313 " fill="none" filter="url(#fldr5w7yiyfiz)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="780.5" y="140.0811">job user</text><ellipse cx="811.5" cy="70.0859" fill="#FEFECE" filter="url(#fldr5w7yiyfiz)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M811.5,78.0859 L811.5,105.0859 M798.5,86.0859 L824.5,86.0859 M811.5,105.0859 L798.5,120.0859 M811.5,105.0859 L824.5,120.0859 " fill="none" filter="url(#fldr5w7yiyfiz)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="780.5" y="1033.2295">job user</text><ellipse cx="811.5" cy="1046.5313" fill="#FEFECE" filter="url(#fldr5w7yiyfiz)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M811.5,1054.5313 L811.5,1081.5313 M798.5,1062.5313 L824.5,1062.5313 M811.5,1081.5313 L798.5,1096.5313 M811.5,1081.5313 L824.5,1096.5313 " fill="none" filter="url(#fldr5w7yiyfiz)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="127" x="852.5" y="140.0811">OAREXEC process</text><ellipse cx="919" cy="111.0859" fill="#FEFECE" filter="url(#fldr5w7yiyfiz)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><polygon fill="#A80036" points="915,99.0859,921,94.0859,919,99.0859,921,104.0859,915,99.0859" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="127" x="852.5" y="1033.2295">OAREXEC process</text><ellipse cx="919" cy="1052.5313" fill="#FEFECE" filter="url(#fldr5w7yiyfiz)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><polygon fill="#A80036" points="915,1040.5313,921,1035.5313,919,1040.5313,921,1045.5313,915,1040.5313" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98" x="1040" y="140.0811">Job's prologue</text><ellipse cx="1092" cy="111.0859" fill="#FEFECE" filter="url(#fldr5w7yiyfiz)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><polygon fill="#A80036" points="1088,99.0859,1094,94.0859,1092,99.0859,1094,104.0859,1088,99.0859" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98" x="1040" y="1033.2295">Job's prologue</text><ellipse cx="1092" cy="1052.5313" fill="#FEFECE" filter="url(#fldr5w7yiyfiz)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><polygon fill="#A80036" points="1088,1040.5313,1094,1035.5313,1092,1040.5313,1094,1045.5313,1088,1040.5313" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96" x="1154" y="140.0811">Job's epilogue</text><ellipse cx="1205" cy="111.0859" fill="#FEFECE" filter="url(#fldr5w7yiyfiz)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><polygon fill="#A80036" points="1201,99.0859,1207,94.0859,1205,99.0859,1207,104.0859,1201,99.0859" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96" x="1154" y="1033.2295">Job's epilogue</text><ellipse cx="1205" cy="1052.5313" fill="#FEFECE" filter="url(#fldr5w7yiyfiz)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><polygon fill="#A80036" points="1201,1040.5313,1207,1035.5313,1205,1040.5313,1207,1045.5313,1201,1040.5313" style="stroke:#A80036;stroke-width:1.0;"/><rect fill="#FFFFFF" filter="url(#fldr5w7yiyfiz)" height="858.8516" style="stroke:#A80036;stroke-width:1.0;" width="10" x="26" y="153.3828"/><rect fill="#FFFFFF" filter="url(#fldr5w7yiyfiz)" height="858.8516" style="stroke:#A80036;stroke-width:1.0;" width="10" x="92.5" y="153.3828"/><rect fill="#FFFFFF" filter="url(#fldr5w7yiyfiz)" height="14" style="stroke:#A80036;stroke-width:1.0;" width="10" x="221.5" y="298.1797"/><rect fill="#FFFFFF" filter="url(#fldr5w7yiyfiz)" height="14" style="stroke:#A80036;stroke-width:1.0;" width="10" x="357.5" y="989.2344"/><rect fill="#FFFFFF" filter="url(#fldr5w7yiyfiz)" height="858.8516" style="stroke:#A80036;stroke-width:1.0;" width="10" x="486.5" y="153.3828"/><rect fill="#FFFFFF" filter="url(#fldr5w7yiyfiz)" height="119.3984" style="stroke:#A80036;stroke-width:1.0;" width="10" x="914" y="775.4375"/><rect fill="#FFFFFF" filter="url(#fldr5w7yiyfiz)" height="14" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1087" y="804.5703"/><rect fill="#FFFFFF" filter="url(#fldr5w7yiyfiz)" height="14" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1200" y="880.8359"/><path d="M525,158.3828 L525,198.3828 L655,198.3828 L655,168.3828 L645,158.3828 L525,158.3828 " fill="#FBFB77" filter="url(#fldr5w7yiyfiz)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M645,158.3828 L645,168.3828 L655,168.3828 L645,158.3828 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108" x="531" y="175.4497">oar has a special</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="531" y="190.5825">shell: oarsh_shell</text><path d="M400,212.6484 L400,267.6484 L579,267.6484 L579,222.6484 L569,212.6484 L400,212.6484 " fill="#FBFB77" filter="url(#fldr5w7yiyfiz)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M569,212.6484 L569,222.6484 L579,222.6484 L569,212.6484 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136" x="406" y="229.7153">the sshd server must</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151" x="406" y="244.8481">be configured to accept</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158" x="406" y="259.981">oar related env variables</text><polygon fill="#A80036" points="209.5,294.1797,219.5,298.1797,209.5,302.1797,213.5,298.1797" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="102.5" x2="215.5" y1="298.1797" y2="298.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="109.5" y="293.1138">server prologue</text><polygon fill="#A80036" points="113.5,308.1797,103.5,312.1797,113.5,316.1797,109.5,312.1797" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="107.5" x2="225.5" y1="312.1797" y2="312.1797"/><polygon fill="#A80036" points="580.5,337.3125,590.5,341.3125,580.5,345.3125,584.5,341.3125" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="496.5" x2="586.5" y1="341.3125" y2="341.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="72" x="503.5" y="336.2466">oarsh_shell</text><path d="M530,354.3125 L530,394.3125 L651,394.3125 L651,364.3125 L641,354.3125 L530,354.3125 " fill="#FBFB77" filter="url(#fldr5w7yiyfiz)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M641,354.3125 L641,364.3125 L651,364.3125 L641,354.3125 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76" x="536" y="371.3794">execute the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="536" y="386.5122">server prologue</text><polygon fill="#A80036" points="474.5,420.7109,484.5,424.7109,474.5,428.7109,478.5,424.7109" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="102.5" x2="480.5" y1="424.7109" y2="424.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="238" x="109.5" y="419.645">job_resource_manager_cgroups "init"</text><polygon fill="#A80036" points="580.5,449.8438,590.5,453.8438,580.5,457.8438,584.5,453.8438" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="496.5" x2="586.5" y1="453.8438" y2="453.8438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="72" x="503.5" y="448.7778">oarsh_shell</text><path d="M536,466.8438 L536,506.8438 L645,506.8438 L645,476.8438 L635,466.8438 L536,466.8438 " fill="#FBFB77" filter="url(#fldr5w7yiyfiz)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M635,466.8438 L635,476.8438 L645,476.8438 L635,466.8438 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88" x="542" y="483.9106">create cpuset</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="542" y="499.0435">for the job</text><polygon fill="#A80036" points="474.5,533.2422,484.5,537.2422,474.5,541.2422,478.5,537.2422" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="102.5" x2="480.5" y1="537.2422" y2="537.2422"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="109.5" y="532.1763">launch_oarexec</text><polygon fill="#A80036" points="580.5,562.375,590.5,566.375,580.5,570.375,584.5,566.375" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="496.5" x2="586.5" y1="566.375" y2="566.375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="72" x="503.5" y="561.3091">oarsh_shell</text><path d="M563,579.375 L563,664.375 L839,664.375 L839,589.375 L829,579.375 L563,579.375 " fill="#FBFB77" filter="url(#fldr5w7yiyfiz)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M829,579.375 L829,589.375 L839,589.375 L829,579.375 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="585.25" y="596.4419">with the environment</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139" x="585.25" y="611.5747">variable OAR_CPUSET</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="219" x="585.25" y="626.7075">the shell used by oar (oarsh_shell)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149" x="585.25" y="641.8403">becomes the job's user</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="208" x="585.25" y="656.9731">and migrates itself to the cpuset</text><line style="stroke:#A80036;stroke-width:1.0;" x1="592.5" x2="634.5" y1="695.1719" y2="695.1719"/><line style="stroke:#A80036;stroke-width:1.0;" x1="634.5" x2="634.5" y1="695.1719" y2="708.1719"/><line style="stroke:#A80036;stroke-width:1.0;" x1="593.5" x2="634.5" y1="708.1719" y2="708.1719"/><polygon fill="#A80036" points="603.5,704.1719,593.5,708.1719,603.5,712.1719,599.5,708.1719" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="196" x="599.5" y="690.106">Migrate itself to $OAR_CPUSET</text><path d="M551,723.1719 L695,723.1719 L695,730.1719 L685,740.1719 L551,740.1719 L551,723.1719 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="179.6641" style="stroke:#000000;stroke-width:2.0;" width="715" x="551" y="723.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="99" x="566" y="736.2388">Inside cpuset</text><polygon fill="#A80036" points="799.5,757.4375,809.5,761.4375,799.5,765.4375,803.5,761.4375" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="592.5" x2="805.5" y1="761.4375" y2="761.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="195" x="599.5" y="756.3716">Become user $OAR_JOB_USER</text><polygon fill="#A80036" points="902,771.4375,912,775.4375,902,779.4375,906,775.4375" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="811.5" x2="908" y1="775.4375" y2="775.4375"/><polygon fill="#A80036" points="1075,800.5703,1085,804.5703,1075,808.5703,1079,804.5703" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="924" x2="1081" y1="804.5703" y2="804.5703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144" x="931" y="799.5044">execute job's prologue</text><polygon fill="#A80036" points="935,814.5703,925,818.5703,935,822.5703,931,818.5703" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="929" x2="1091" y1="818.5703" y2="818.5703"/><polygon fill="#FBFB77" filter="url(#fldr5w7yiyfiz)" points="876,831.5703,961,831.5703,971,842.5703,961,854.5703,876,854.5703,866,842.5703,876,831.5703" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="81" x="878" y="847.6372">job executes</text><polygon fill="#A80036" points="1188,876.8359,1198,880.8359,1188,884.8359,1192,880.8359" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="924" x2="1194" y1="880.8359" y2="880.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="931" y="875.77">execute job's epilogue</text><polygon fill="#A80036" points="930,890.8359,920,894.8359,930,898.8359,926,894.8359" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="924" x2="1204" y1="894.8359" y2="894.8359"/><polygon fill="#A80036" points="474.5,926.9688,484.5,930.9688,474.5,934.9688,478.5,930.9688" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="36" x2="480.5" y1="930.9688" y2="930.9688"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="253" x="43" y="925.9028">job_resource_manager_cgroups "clean"</text><polygon fill="#A80036" points="580.5,956.1016,590.5,960.1016,580.5,964.1016,584.5,960.1016" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="496.5" x2="586.5" y1="960.1016" y2="960.1016"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="72" x="503.5" y="955.0356">oarsh_shell</text><polygon fill="#A80036" points="345.5,985.2344,355.5,989.2344,345.5,993.2344,349.5,989.2344" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="36" x2="351.5" y1="989.2344" y2="989.2344"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="43" y="984.1685">server epilogue</text><polygon fill="#A80036" points="47,999.2344,37,1003.2344,47,1007.2344,43,1003.2344" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="41" x2="361.5" y1="1003.2344" y2="1003.2344"/><!--MD5=[575398090a6d5b6868c29d5c966e003f]
@startuml
title Job's execution chain
box "Server" #LightBlue
  participant Leon as leon
  participant Bipbip as bipbip
  control "Server's prologue" as sprologue
  control "Server's epilogue" as sepilogue
end box
box "Head Node" #LightGreen
  control "dedicated sshd" as sshd
  actor "oar user" as oar
  actor "job user" as user
  control "OAREXEC process" as OAREXEC
  control "Job's prologue" as prologue
  control "Job's epilogue" as epilogue
end box
note over oar
  oar has a special
  shell: oarsh_shell
end note

note over sshd
  the sshd server must
  be configured to accept
  oar related env variables
end note

bipbip++
sshd++
leon++

bipbip -> sprologue : server prologue
sprologue++
bipbip <- sprologue
sprologue- -

sshd - -> oar : oarsh_shell
note over oar
  execute the
  server prologue
end note
bipbip -> sshd : job_resource_manager_cgroups "init"
sshd - -> oar : oarsh_shell
note over oar
  create cpuset
  for the job
end note

bipbip -> sshd : launch_oarexec
sshd - -> oar : oarsh_shell
note over oar, user
  with the environment
  variable OAR_CPUSET
  the shell used by oar (oarsh_shell)
  becomes the job's user
  and migrates itself to the cpuset
end note

oar -> oar: Migrate itself to $OAR_CPUSET
group Inside cpuset
  oar -> user: Become user $OAR_JOB_USER
  user -> OAREXEC
  OAREXEC++
  OAREXEC -> prologue: execute job's prologue
  prologue++
  OAREXEC <- prologue
  prologue- -

  hnote over OAREXEC
    job executes
  end hnote

  ' Job terminated
  OAREXEC -> epilogue: execute job's epilogue
  epilogue++
  OAREXEC <- epilogue
  epilogue- -
  OAREXEC- -
end

leon -> sshd : job_resource_manager_cgroups "clean"
sshd - -> oar : oarsh_shell

leon -> sepilogue : server epilogue
sepilogue++
leon <- sepilogue
sepilogue- -

@endumlgo

@startuml
title Job's execution chain
box "Server" #LightBlue
  participant Leon as leon
  participant Bipbip as bipbip
  control "Server's prologue" as sprologue
  control "Server's epilogue" as sepilogue
end box
box "Head Node" #LightGreen
  control "dedicated sshd" as sshd
  actor "oar user" as oar
  actor "job user" as user
  control "OAREXEC process" as OAREXEC
  control "Job's prologue" as prologue
  control "Job's epilogue" as epilogue
end box
note over oar
  oar has a special
  shell: oarsh_shell
end note

note over sshd
  the sshd server must
  be configured to accept
  oar related env variables
end note

bipbip++
sshd++
leon++

bipbip -> sprologue : server prologue
sprologue++
bipbip <- sprologue
sprologue- -

sshd - -> oar : oarsh_shell
note over oar
  execute the
  server prologue
end note
bipbip -> sshd : job_resource_manager_cgroups "init"
sshd - -> oar : oarsh_shell
note over oar
  create cpuset
  for the job
end note

bipbip -> sshd : launch_oarexec
sshd - -> oar : oarsh_shell
note over oar, user
  with the environment
  variable OAR_CPUSET
  the shell used by oar (oarsh_shell)
  becomes the job's user
  and migrates itself to the cpuset
end note

oar -> oar: Migrate itself to $OAR_CPUSET
group Inside cpuset
  oar -> user: Become user $OAR_JOB_USER
  user -> OAREXEC
  OAREXEC++
  OAREXEC -> prologue: execute job's prologue
  prologue++
  OAREXEC <- prologue
  prologue- -

  hnote over OAREXEC
    job executes
  end hnote

  OAREXEC -> epilogue: execute job's epilogue
  epilogue++
  OAREXEC <- epilogue
  epilogue- -
  OAREXEC- -
end

leon -> sshd : job_resource_manager_cgroups "clean"
sshd - -> oar : oarsh_shell

leon -> sepilogue : server epilogue
sepilogue++
leon <- sepilogue
sepilogue- -

@endumlgo

PlantUML version 1.2021.3(Mon Mar 22 17:53:19 CET 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>